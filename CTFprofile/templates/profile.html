{% extends 'base.html' %}
{% block title %}CTFman - {{ p_user.username }} {% endblock %}
{% load staticfiles %}
{% block content %}
    <div class="page-header">
        <h1>{{ p_user.username }}'s profile</h1>
    </div>

    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active">
            <a href="#profile" aria-controls="home" role="tab" data-toggle="tab">Profile</a></li>
        <li role="presentation">
            <a href="#events" aria-controls="home" role="tab" data-toggle="tab">Events</a></li>
        <li role="presentation">
            <a href="#statistics" aria-controls="home" role="tab" data-toggle="tab">Statistics</a></li>
    </ul>

    <div class="tab-content">
        <div  class="tab-pane fade in active" id="profile">
            <h3>User Details</h3>
            <p id="p_username">Username: {{ p_user.username }}</p>
            <p id="join-date">Joined on: {{ p_user.date_joined|date }}</p>
            <p id="last-login">Last seen: {{ p_user.last_login|date }}</p>
            <p id="total-score">Total score: {{ p_user.total_score }}</p>
        </div>
        <div class="tab-pane fade" id="events">
            <h3>Participated in:</h3>
            <ul id="joined_event_list" class="list-group">
            {% for event in events %}
                <li class="list-group-item">{{ event.name }}</li>
            {% empty %}
                <li class="list-group-item list-group-item-danger">This user hasn't joined any events yet!</li>
            {% endfor %}
            </ul>
        </div>

        <div class="tab-pane fade" id="statistics">
            <h1>Score over time</h1>
            <script type="text/javascript" src="{% static 'js/Chart102.min.js' %}"></script>
            <div class="row">
                <div class="col-md-6">
                   <canvas id="myChart" height="300" width="550"></canvas>
                </div>
                <div class="col-md-6">
                   <canvas id="myChart2" height="300" width="550"></canvas>
                </div>
                <style scoped>
                    canvas {
                        width: 100% !important;
                        max-width: 800px;
                        height: auto !important;
                    }
                </style>
            </div>
            <script type="text/javascript">
                $.get('{% url "line_chart_json" %}', function(data) {
                    var ctx = $("#myChart").get(0).getContext("2d");
                    var ctx1 = $("#myChart2").get(0).getContext("2d");
                    new Chart(ctx).Line(data);
                    new Chart(ctx1).Line(data);
                });
            </script>
        </div>
    </div>

{% endblock %}